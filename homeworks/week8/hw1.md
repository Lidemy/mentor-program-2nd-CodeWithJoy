# 設計短網址的服務

## 流程：
1. client端發送長的url到server端
2. 送到server時會先經過load balancer(高可用性、自動擴展、提高容錯) 分流（有不同的分流方式，最常見的是均勻派發）
3. server端得到長url後，在資料庫進行比對
  a. 若已有縮用過後的短網址，回傳短網址給client
  b. 若沒有，則新增短網址，把對應資料儲存資料庫並回傳給client

## 可能問題：
1. 如何增進效能？

  如果是增進server運行效能，則合理分配流量是很重要的。

  如果是增進搜尋效能，則可以解析傳入網址，讓類似的IP位置（總共四組數字，每組有1-255個數字，因此會有相似者）對應類似的編碼)，而不是每次都整組隨機生成。
  如果是增進新增短網址效能（即之前沒有人縮過這個網址），則我想可以讓短網址用“輪派”的方式發送（有點類似點餐的號碼牌，客人每天幾千人，點餐牌輪序的可能只有幾百號），輪派可能會比隨機新增更有效率一點，也確保不會撞車，至於輪派號碼，現行大部分短網址服務採用的是62進位制（a~z, A~Z, 0-9）的6碼網址，號碼牌也很夠用，甚至如果不想要這麼多號碼牌，可能設定如果超過5年以上沒被存取的網址就釋出號碼重新進入列隊，讓號碼牌也不用這麼多


ps. 後來看解答的部分，有說到cache的機制，等於也可以先儲存些資訊在client端的電腦or browser裡面，這樣在進入到server前就可以回傳資訊了

2. 如何加大規模(scaling)？

   目前有些load balancing 服務提供者就提供自動擴展load balancer的功能，另外，多連接些主機也能服務更大規模的client requests.3


3. 如何備援資料？

   本來主機中就有所謂的mater & servants。彼此資料同步，master可以主要負責寫入新資訊，servants負責讀取資訊與傳送訊息。而由於同時不只一台master & servant，彼此資料共享，即使有一台機器掛掉，資料還是會在其他機器保存。（甚至可以是有一台主機專門中央式備份所有資料，而其他外面的資料庫可能都只有存入一部分資料，只要外部資料庫掛掉，可用中央補足，而中央儲存庫掛掉，則重新由外面資料庫把所有資料湊回來。而由於不同資料庫只存入部分資料，而一開始client端傳入request就已分流，所以也可以不用太耗資源的檢索or新增短網址。）


